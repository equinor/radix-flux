# Versions for all third-party components and radix-components deployed by flux
---
apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: blob-csi-driver
  namespace: kube-system
spec:
  chart:
    spec:
      version: v1.5.0           # https://github.com/kubernetes-sigs/blob-csi-driver/releases
---
apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: cert-manager
  namespace: cert-manager
spec:
  chart:
    spec:
      version: 1.5.3            # https://github.com/jetstack/cert-manager/releases
---
apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: dynatrace-operator
  namespace: dynatrace
spec:
  chart:
    spec:
      version: 0.2.1            # https://github.com/Dynatrace/helm-charts/releases
---
apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: external-dns
  namespace: default
spec:
  chart:
    spec:
      version: 5.0.3            # helm search repo bitnami/external-dns
---
apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: grafana
  namespace: default
spec:
  chart:
    spec:
      version: 6.12.0          # https://github.com/grafana/helm-charts/releases
---
apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: ingress-nginx
  namespace: default
spec:
  chart:
    spec:
      version: 3.32.0           # https://github.com/kubernetes/ingress-nginx/releases
---
apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: kube-prometheus-stack
  namespace: default
spec:
  chart:
    spec:
      version: 16.5.0           # https://github.com/prometheus-community/helm-charts/releases
---
apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: kubed
  namespace: kube-system
spec:
  chart:
    spec:
      version: v0.12.0          # https://github.com/kubeops/kubed/releases
---
apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: kured
  namespace: default
spec:
  chart:
    spec:
      version: 2.6.0            # helm search repo kured/kured
---
apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: velero
  namespace: velero
spec:
  chart:
    spec:
      version: 2.21.1          # https://github.com/vmware-tanzu/helm-charts/releases
---
apiVersion: source.toolkit.fluxcd.io/v1beta1
kind: GitRepository
metadata:
  name: radix-acr-cleanup
  namespace: default
spec:
  ref:
    branch: release
---
apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: radix-acr-cleanup
  namespace: default
spec:
  values:
    registry: radixprod
    deleteUntagged: false
    retainLatestUntagged: 0
    image:
      repository: radixprod.azurecr.io/radix-acr-cleanup
      tag: master-c98af28a1c7f03950f6ea3eb7ac4b1a2544b5178
---
apiVersion: source.toolkit.fluxcd.io/v1beta1
kind: GitRepository
metadata:
  name: radix-cicd-canary
  namespace: radix-cicd-canary
spec:
  ref:
    branch: release
---
apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: radix-cicd-canary
  namespace: radix-cicd-canary
spec:
  values:
    radixApiPrefix: server-radix-api-prod
    radixWebhookPrefix: webhook-radix-github-webhook-prod
    image:
      repository: radixprod.azurecr.io/radix-cicd-canary
      tag: release-2c1b406e5f4270cf3415bf60ccef47671fe225e1
---
apiVersion: source.toolkit.fluxcd.io/v1beta1
kind: GitRepository
metadata:
  name: radix-cost-allocation
  namespace: radix-cost-allocation
spec:
  ref:
    branch: release
---
apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: radix-cost-allocation
  namespace: radix-cost-allocation
spec:
  values:
    image:
      repository: radixprod.azurecr.io/radix-cost-allocation
      tag: release-latest
    db:
      server: sql-radix-cost-allocation-prod.database.windows.net
    resources:
      limits:
        memory: 300Mi
      requests:
        memory: 300Mi
---
apiVersion: source.toolkit.fluxcd.io/v1beta1
kind: GitRepository
metadata:
  name: radix-operator
  namespace: default
spec:
  ref:
    branch: release
---
apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: radix-operator
  namespace: default
spec:
  values:
    image:
      repository: radixprod.azurecr.io/radix-operator
      tag: release-4cbc600ad252dea5796393b017bfbf3b1fd1ee9e
    activeClusterName: eu-39
    imageBuilder: radix-image-builder:release-latest
    imageScanner: radix-image-scanner:release-latest
    configToMap: radix-config-2-map:release-latest
    jobScheduler: radix-job-scheduler:release-latest
    containerRegistry: radixprod.azurecr.io
    resources:
      limits:
        memory: 8000Mi
      requests:
        memory: 4000Mi
